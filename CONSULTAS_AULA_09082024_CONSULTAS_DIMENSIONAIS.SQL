-- VALOR DE VENDA DE TODAS AS UNIDADES NO ANO DE 2019
SELECT
	D_DATA.DS_MES_ANO,
	SUM(F_PEDIDOS.VL_VENDA) AS V1_VENDA
FROM 
	F_PEDIDOS,
	D_DATA
WHERE
	D_DATA.SK_DATA = F_PEDIDOS.SK_DATA_PEDIDO
	AND
	D_DATA.NR_ANO = 2019
GROUP BY
	DS_MES_ANO,
	NR_ANO_MES
ORDER BY 
	NR_ANO_MES;
    

-- VALOR DE VENDA DA CIDADE DE SÃO PAULO NO ESTADO DE SAO NO ANO DE 2019 DE ABRIL
SELECT 
    D_PRODUTO.DS_PRODUTO,
    SUM(F_PEDIDOS.VL_VENDA) AS VL_VENDA
FROM
    D_PRODUTO,
    D_DATA,
    D_LOJA,
    F_PEDIDOS
WHERE 
    D_PRODUTO.SK_PRODUTO = F_PEDIDOS.SK_PRODUTO
    AND
    D_DATA.SK_DATA = F_PEDIDOS.SK_DATA_PEDIDO
    AND
    D_LOJA.SK_LOJA = F_PEDIDOS.SK_LOJA
    AND
    D_DATA.NR_ANO_MES = 201904
    AND
    D_LOJA.NM_CIDADE = 'São Paulo'
    AND
    D_LOJA.SG_ESTADO = 'SP'
GROUP BY DS_PRODUTO
ORDER BY VL_VENDA DESC
FETCH FIRST 5 ROWS ONLY;
    

-- 
SELECT
    D_CLIENTE.NR_CLIENTE,
    D_CLIENTE.NM_CLIENTE,
    D_CLIENTE.NM_CIDADE,
    D_CLIENTE.SG_ESTADO
SUM(VL_VENDA) AS VL_VENDA,
FROM
D_CLIENTE,
D_DATA,
F_PEDIDOS
WHERE D_DATA.SK_DATA = F_PEDIDOS.SK_DATA_PEDIDO
AND D_CLIENTE.SK_CLIENTE = F = F_PEDIDOS.SK_CLIENTE
AND D_DATA.DS_TRIMESTRE_ANO = '2° TRIMESTRE/2019'
AND D_CLIENTE.DS_TRIMESTRE_ANO = 'PESSOA FÍSICA'
GROUP BY
D_CLIENTE.NR_CLIENTE,
D_CLIENTE.NM_CLIENTE,
D_CLIENTE.NM_CIDADE,
D_CLIENTE.SG_ESTADO
ORDER BY VL_VENDA DESC
FETCH FIRST´10 ROWS ONLY;






